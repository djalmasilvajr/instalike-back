"use strict";function _typeof(o){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o})(o)}function _classCallCheck(o,t){if(!(o instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(o,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(o,_toPropertyKey(r.key),r)}}function _createClass(o,t,a){return t&&_defineProperties(o.prototype,t),a&&_defineProperties(o,a),Object.defineProperty(o,"prototype",{writable:!1}),o}function _toPropertyKey(o){o=_toPrimitive(o,"string");return"symbol"==_typeof(o)?o:String(o)}function _toPrimitive(o,t){if("object"!=_typeof(o)||!o)return o;var a=o[Symbol.toPrimitive];if(void 0===a)return("string"===t?String:Number)(o);a=a.call(o,t||"default");if("object"!=_typeof(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}var Bookmark=function(){function o(){_classCallCheck(this,o),this.lightcardBookmarkButton=$(".lightCard-bookmark"),this.bookmarkButton=$(".bookmark-button"),this.courseBookmarkButton=$(".course-bookmark-button"),this.careerCourseBookmarkButton=$(".career-courses__bookmark"),this.learningGuideBookmarkButton=$(".btn-seguir"),this.studyPlanB2BBookmarkButton=$(".study-plan__follow-button"),this.bookmarkCounter=$(".bookmark-counter"),this.bookmarkCounterValue=this.bookmarkCounter?parseInt(this.bookmarkCounter.html()):0,this.ajaxLoading=!1,this.bookmarkMessages={showOnDashboard:"Exibir na Dashboard",showingOnDashboard:"Exibindo na Dashboard"}}return _createClass(o,[{key:"lightcardBookmarkClick",value:function(o){var t=this,a=$(o.currentTarget),r=a.attr("data-course-code");this.post(o,r,function(){a.find(".lightCard-bookmark-checked-icon, .lightCard-bookmark-unchecked-icon").toggle(),t.ajaxLoading=!1})}},{key:"setMessages",value:function(o,t){this.bookmarkMessages={showOnDashboard:o,showingOnDashboard:t}}},{key:"bookmarkClick",value:function(o){var t=this,a=$(o.currentTarget),r=a.data("course-code");this.post(o,r,function(){"true"==a.attr("data-bookmarked")?(a.html(a.attr("data-bookmark-display")),a.attr("data-bookmarked",!1),a.removeClass("bookmark-button--bookmarked")):(a.html(a.attr("data-unbookmark-display")),a.attr("data-bookmarked",!0),a.addClass("bookmark-button--bookmarked")),t.ajaxLoading=!1})}},{key:"courseBookmarkClick",value:function(o){var t=this,a=$(o.currentTarget),r=a.data("course-code");this.post(o,r,function(){"true"==a.attr("data-bookmarked")?(a.find("h2").text(a.attr("data-bookmark-display")),a.attr("data-bookmarked",!1),a.removeClass("course-bookmark-button--bookmarked"),a.parent().attr("data-bookmarked",!1)):(a.find("h2").text(a.attr("data-unbookmark-display")),a.attr("data-bookmarked",!0),a.addClass("course-bookmark-button--bookmarked"),a.parent().attr("data-bookmarked",!0)),t.ajaxLoading=!1})}},{key:"careerCourseBookmarkClick",value:function(o){var t=this,a=$(o.target),r=a.attr("data-course-code");o.preventDefault(),o.stopPropagation(),this.post(o,r,function(){a.toggleClass("career-courses__bookmark--bookmarked"),t.ajaxLoading=!1},!0)}},{key:"studyPlanB2BClick",value:function(o){var t=$(o.target),o=t.attr("data-guide-code"),a="true"===t.attr("data-bookmarked");this.requestB2B(o,function(){t.toggleClass("study-plan__follow-button--following"),t.attr("data-bookmarked",!a),this.ajaxLoading=!1}.bind(this),a)}},{key:"updateCounter",value:function(o){this.bookmarkCounter&&(o?--this.bookmarkCounterValue:this.bookmarkCounterValue+=1,this.bookmarkCounter.text(this.bookmarkCounterValue))}},{key:"learningGuideBookmarkClick",value:function(o){var n=this,i=(o.preventDefault(),o.stopPropagation(),$(o.currentTarget.parentNode)),t=i.attr("data-guide-id"),s="true"==i.attr("data-is-bookmarked").toLowerCase(),k=s?"#051933":"transparent",u=s?"#FFFFFF":"#051933",c=s?"rgba(0, 0, 0, 0.3)":"#FFF",d=s?"rgba(0, 0, 0, 0.3)":i.css("color"),l=s?"#D7DBDF":"#2087ED",b=s?this.bookmarkMessages.showOnDashboard:this.bookmarkMessages.showingOnDashboard,t="/learningGuide/".concat(t,"/")+(s?"unbookmark":"bookmark");this.learningGuideBookmarkPost(o,t,function(){n.updateCounter(s);var o=i.find(".btn-seguir-slider"),t=i.find(".sliderDegree"),a=i.find(".sliderStudyPlan"),r=i.find(".sliderCorpPlan"),e=i.find(".sliderPublicGuide");i.find(">:first-child").text(b),o.css("background-color",k),t.css("background-color",k),t.css("color",u),a.css("background-color",d),r.css("background-color",c),e.css("background-color",l),o.toggleClass("btn-seguir-slider--checked"),i.attr("data-is-bookmarked",!s),n.ajaxLoading=!1},!0)}},{key:"post",value:function(o,t,a){this.ajaxLoading||(this.ajaxLoading=!0,$.post("/courses/toggle-bookmark",{courseCode:t}).done(function(){a()}).fail(function(){window.alert("Ocorreu um erro!")}))}},{key:"requestB2B",value:function(o,t,a){this.ajaxLoading||(this.ajaxLoading=!0,o="learningGuide/".concat(o,a?"/unbookmark":"/bookmark"),$.post(o,t))}},{key:"learningGuideBookmarkPost",value:function(o,t,a){this.ajaxLoading||(this.ajaxLoading=!0,$.post(t).done(function(){a()}).fail(function(){window.alert("Ocorreu um erro! Por favor, tente novamente.")}))}},{key:"refreshListener",value:function(){this.lightcardBookmarkButton.on("click",this.lightcardBookmarkClick.bind(this)),this.bookmarkButton.on("click",this.bookmarkClick.bind(this)),this.courseBookmarkButton.on("click",this.courseBookmarkClick.bind(this)),this.careerCourseBookmarkButton.on("click",this.careerCourseBookmarkClick.bind(this)),this.learningGuideBookmarkButton.on("click",this.learningGuideBookmarkClick.bind(this)),this.studyPlanB2BBookmarkButton.on("click",this.studyPlanB2BClick.bind(this))}}]),o}();